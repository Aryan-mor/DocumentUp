// Generated by CoffeeScript 1.3.1
(function() {

  (function($) {
    return $.extend($.fn, {
      scrollTo: function(position, duration, easing, callback) {
        var animate, finish_time, interpolate, scroll_to, start_time, start_y, _ref, _ref1,
          _this = this;
        if (typeof duration === "function") {
          _ref = [duration, callback], callback = _ref[0], duration = _ref[1];
        }
        if (typeof easing === "function") {
          _ref1 = [easing, callback], callback = _ref1[0], easing = _ref1[1];
        }
        duration || (duration = 200);
        if (typeof position === "number") {
          scroll_to = position - this.offset().top;
        } else if (typeof position === "string") {
          scroll_to = $(position)[0].offsetTop - this.offset().top;
        } else {
          scroll_to = position[0].offsetTop - this.offset().top;
        }
        scroll_to || (scroll_to = $.os.android && 1 || 0);
        interpolate = function(source, target, shift) {
          return source + (target - source) * shift;
        };
        typeof easing !== "function" && (easing = function(pos) {
          return (-Math.cos(pos * Math.PI) / 2) + .5;
        });
        start_y = this[0].scrollTop;
        start_time = Date.now();
        finish_time = start_time + duration;
        (animate = function() {
          var now, shift;
          now = +(new Date());
          shift = (now > finish_time ? 1 : (now - start_time) / duration);
          _this[0].scrollTop = interpolate(start_y, scroll_to, easing(shift));
          if (now < finish_time) {
            return setTimeout(animate, 15);
          } else {
            return callback(_this);
          }
        })();
        return this;
      }
    });
  })(Zepto);

  Zepto(function() {
    var return_to_doc, show_toc;
    setTimeout(function() {
      return window.scrollTo(0, 1);
    });
    $("#document-view > header").on("singleTap", function() {
      return $("#document-view .content > section").scrollTo(0);
    });
    return_to_doc = function(event) {
      if (event) {
        event.preventDefault();
        event.stopPropagation();
      }
      $("#document-view").off("singleTap swipeRight", return_to_doc);
      $("#toc-view").off("swipeRight", return_to_doc);
      $("#document-view, #toc-view").addClass("in-transit");
      return $("#document-view").animate({
        translate3d: "0,0,0"
      }, 300, "ease", function() {
        return $("#document-view, #toc-view").removeClass("in-transit");
      });
    };
    show_toc = function(event) {
      event.preventDefault();
      event.stopPropagation();
      $("#document-view, #toc-view").addClass("in-transit");
      return $("#document-view").animate({
        translate3d: "-80%,0,0"
      }, 300, "ease", function() {
        $("#document-view, #toc-view").removeClass("in-transit");
        $("#document-view").on("singleTap swipeRight", return_to_doc);
        return $("#toc-view").on("swipeRight", return_to_doc);
      });
    };
    $(".button-toc").on("singleTap", show_toc);
    $("#toc-view li a").on("singleTap", function(event) {
      event.preventDefault();
      return_to_doc();
      return $("#document-view .content > section").scrollTo(event.target.hash, 400);
    });
    return $("code, pre").on("swipe", function(event) {
      return false;
    });
  });

}).call(this);
